# üöÄ AUT√îNOMO CONTROL

*Sistema completo de gest√£o financeira para profissionais aut√¥nomos*

![Status](https://img.shields.io/badge/Backend-100%25-brightgreen)
![Status](https://img.shields.io/badge/Frontend-95%25-brightgreen)
![Status](https://img.shields.io/badge/MVP-95%25-brightgreen)
![Tests](https://img.shields.io/badge/Tests-300%2B-brightgreen)
![Coverage](https://img.shields.io/badge/Coverage-99%25-brightgreen)
![Performance](https://img.shields.io/badge/Anti--Flickering-‚úÖ-brightgreen)
![TypeScript](https://img.shields.io/badge/TypeScript-Zero%20Errors-brightgreen)
![Testing](https://img.shields.io/badge/Jest-Migrated-brightgreen)

---

## üéØ **Prop√≥sito**

O Aut√¥nomo Control √© uma aplica√ß√£o de gest√£o financeira desenvolvida especificamente para profissionais aut√¥nomos brasileiros - motoristas de aplicativo, entregadores, freelancers e outros trabalhadores independentes.

### **Objetivos Principais:**
- üí° **Simplificar** o controle financeiro di√°rio
- üìä **Facilitar** o c√°lculo de lucratividade real
- üìà **Proporcionar** visibilidade sobre tend√™ncias financeiras
- üéØ **Auxiliar** no planejamento e declara√ß√µes fiscais

---

## üìã **Documenta√ß√£o Principal**

### üéØ **[üìö Documenta√ß√£o Completa](docs/INDICE.md)**
**Acesse a documenta√ß√£o completa** para obter todas as informa√ß√µes sobre instala√ß√£o, uso, desenvolvimento e manuten√ß√£o do sistema.

### üöÄ **Comece Aqui**
- [Guia de In√≠cio R√°pido](docs/00_guia_rapido/guia_inicio_rapido.md) - Comece a usar o Aut√¥nomo Control rapidamente
- [Instru√ß√µes de Login](docs/01_instalacao/instrucoes_login.md) - Como configurar e acessar sua conta
- [Perguntas Frequentes](docs/00_guia_rapido/faq.md) - Respostas para d√∫vidas comuns

### üìö **Documenta√ß√£o T√©cnica**
- [Vis√£o Geral da Arquitetura](docs/02_arquitetura/visao_geral.md) - Vis√£o geral da arquitetura do sistema
- [Backend](docs/02_arquitetura/backend/estrutura.md) - Documenta√ß√£o t√©cnica do backend
- [Frontend](docs/02_arquitetura/frontend/estrutura.md) - Documenta√ß√£o t√©cnica do frontend
- üîë **[Instru√ß√µes de Login](docs/historico/unificacao_30_05_2025/INSTRUCOES_LOGIN.md)** - Configura√ß√£o de autentica√ß√£o
- ‚ö° **[Otimiza√ß√µes Anti-Flickering](docs/ANTI_FLICKERING_OPTIMIZATIONS.md)** - Performance improvements
- üß™ **[Testes E2E](frontend/e2e/)** - Testes end-to-end com Playwright
- üìÅ **[Arquivo Hist√≥rico](docs/historico/)** - Documentos consolidados anteriores

---

## üÜï **Melhorias Recentes**

### ‚úÖ **Corre√ß√µes de TypeScript (Janeiro 2025)**
- **Zero erros TypeScript**: Resolvidos mais de 65 erros de tipagem
- **Migra√ß√£o Jest**: Convertido de Vitest para Jest com Testing Library
- **Tipagem aprimorada**: Interfaces `Entry`, `Category`, `SecurityQuestion` padronizadas
- **IDs consistentes**: Migra√ß√£o de `number` para `string` em todos os componentes
- **Hooks otimizados**: `useAuth` e `useToast` com tipagem correta
- **Testes robustos**: 300+ testes unit√°rios e de integra√ß√£o
- **E2E implementado**: Testes end-to-end com Playwright
- **Scripts de corre√ß√£o**: Ferramentas autom√°ticas para manuten√ß√£o de c√≥digo

### üîß **Melhorias T√©cnicas**
- **Backend completo**: API FastAPI com estrutura modular
- **Seguran√ßa aprimorada**: Sistema de roles RBAC (USER/ADMIN/MASTER)
- **Testes abrangentes**: Cobertura de 99% no backend
- **Configura√ß√£o Supabase**: Integra√ß√£o com banco de dados em nuvem
- **Scripts administrativos**: Ferramentas para gest√£o de usu√°rios

---

## ‚ö° **Quick Start**
Roteiro m√≠nimo para ter o sistema rodando em menos de 5 minutos.

### 1. Pr√©‚Äërequisitos
- Python 3.12+
- Node.js 18+ / npm
- (Opcional) pyenv ou virtualenv

### 2. Clonar e configurar ambiente
```bash
git clone https://github.com/davidassef/Autonomo_Control.git
cd Autonomo_Control
cp backend/.env.example backend/.env  # Ajuste SECRET_KEY se quiser
```

### 3. Backend (FastAPI)
```bash
cd backend
python -m venv .venv
source .venv/bin/activate  # Windows: .venv\Scripts\activate
pip install -r requirements.txt
python scripts/utils/seed_data.py   # (opcional) popula categorias + corridas fict√≠cias
python scripts/utils/run_server.py  # Servir√° em http://127.0.0.1:8000 (requer venv ATIVA)

# Dica:
# Se aparecer "ModuleNotFoundError: No module named 'sqlalchemy'" o motivo quase sempre √© a venv n√£o ativada.
# O script agora exibe instru√ß√µes autom√°ticas quando depend√™ncias faltam.

# Alternativa direta (mesmo efeito do scripts/utils/run_server.py):
# uvicorn app.main:app --reload --host 127.0.0.1 --port 8000
```
Swagger/OpenAPI: http://127.0.0.1:8000/docs

### 4. Frontend (React)
Em outro terminal:
```bash
cd frontend
npm install
npm start   # http://localhost:3000
```

### 5. Login / Usu√°rio de Seed
O seed cria usu√°rio system@seed (Google ID fict√≠cio). Para fluxo real de login Google implemente vari√°veis `GOOGLE_CLIENT_ID` etc. (ver `.env.example`).

### 5.1 Roles & Administra√ß√£o (RBAC)
O sistema agora suporta tr√™s n√≠veis hier√°rquicos de acesso:

| Role | Pode | N√£o Pode |
|------|------|----------|
| USER | Gerenciar seus pr√≥prios lan√ßamentos e categorias | Acessar rota `/admin` |
| ADMIN | Tudo de USER + listar usu√°rios, criar USER, desativar USER | Criar ADMIN, promover roles sem MASTER password |
| MASTER | Tudo de ADMIN + criar ADMIN, promover/rebaixar, desativar ADMIN | Desativar ou alterar o pr√≥prio MASTER |

Opera√ß√µes cr√≠ticas (criar ADMIN, alterar role, desativar ADMIN) exigem cabe√ßalho adicional:
`X-Master-Key: <MASTER_PASSWORD>`

Configure no arquivo `.env`:
```
MASTER_EMAIL=seu.email+master@dominio.com
MASTER_PASSWORD=defina-uma-senha-forte
```
No primeiro start / seed:
- Se `MASTER_EMAIL` n√£o existir => usu√°rio MASTER criado.
- Se existir como USER/ADMIN => promovido a MASTER.

Exemplo criar ADMIN (via curl):
```bash
curl -X POST \
        -H "Authorization: Bearer <TOKEN_MASTER>" \
        -H "X-Master-Key: $MASTER_PASSWORD" \
        -H "Content-Type: application/json" \
        http://127.0.0.1:8000/api/v1/admin/users?role=ADMIN \
        -d '{"email":"novo.admin@example.com","name":"Novo Admin"}'
```

Promover USER ‚Üí ADMIN:
```bash
curl -X PATCH \
        -H "Authorization: Bearer <TOKEN_MASTER>" \
        -H "X-Master-Key: $MASTER_PASSWORD" \
        -H "Content-Type: application/json" \
        http://127.0.0.1:8000/api/v1/admin/users/<USER_ID>/role \
        -d '{"role":"ADMIN"}'
```

Desativar USER (ADMIN ou MASTER):
```bash
curl -X PATCH \
        -H "Authorization: Bearer <TOKEN_ADMIN_OU_MASTER>" \
        -H "Content-Type: application/json" \
        http://127.0.0.1:8000/api/v1/admin/users/<USER_ID>/status \
        -d '{"is_active":false}'
```

Notas de seguran√ßa:
- N√ÉO commit o `.env` com `MASTER_PASSWORD` real.
- Troque a master password periodicamente.
- Em produ√ß√£o armazene hash (futuro: `MASTER_PASSWORD_HASH`).

### 5.2 Painel Admin (UI)
Interface web b√°sica dispon√≠vel em `/admin/users` (acesso restrito a ADMIN e MASTER), com recursos:

| Recurso | USER | ADMIN | MASTER | Observa√ß√µes |
|---------|------|-------|--------|-------------|
| Listagem usu√°rios | ‚ùå | ‚úÖ | ‚úÖ | Pagina√ß√£o futura (atual: lista completa) |
| Criar USER | ‚ùå | ‚úÖ | ‚úÖ | Formul√°rio inline |
| Criar ADMIN | ‚ùå | ‚ùå | ‚úÖ | Exige modal com Master Password |
| Promover USER‚ÜíADMIN | ‚ùå | ‚ùå | ‚úÖ | Bot√£o + modal master password |
| Rebaixar ADMIN‚ÜíUSER | ‚ùå | ‚ùå | ‚úÖ | Bot√£o + modal master password |
| Ativar/Desativar USER | ‚ùå | ‚úÖ | ‚úÖ | Toggle direto |
| Ativar/Desativar ADMIN | ‚ùå | ‚ùå | ‚úÖ | Toggle bloqueado para ADMIN comum |
| Desativar MASTER | ‚ùå | ‚ùå | ‚ùå | Sempre bloqueado |

UX / Seguran√ßa:
- Campo Master Password nunca √© armazenado; limpa ap√≥s tentativa.
- A√ß√µes cr√≠ticas mostram feedback via toasts.
- Skeletons exibidos durante carregamento inicial.
- N√£o √© poss√≠vel desativar o pr√≥prio usu√°rio logado nem o MASTER.
- Erros 403 diferenciados (permiss√£o vs master password inv√°lida) no modal.

Roadmap UI Admin (pr√≥ximos incrementos): pagina√ß√£o, filtros por role/status, busca, audit trail vis√≠vel, exporta√ß√£o CSV.

### 6. Testes R√°pidos
```bash
cd backend
pytest -q
```

Frontend (inclui testes iniciais painel admin):
```bash
cd frontend
npm run test:ci
```

Relat√≥rio de cobertura frontend √© exibido em terminal (scripts adicionados Fase 5).

### Testes E2E (Playwright)
```bash
cd frontend
npm run test:e2e
```

Testes end-to-end incluem valida√ß√£o de login e interface visual.

### 7. Estrutura de Pastas Essencial
```
backend/
        app/ (api, models, schemas, services)
        seed_data.py
frontend/
        src/
                components/, hooks/, pages/, services/
```

### 8. Comandos √öteis
```bash
# Regenerar banco local (cuidado: perde dados)
rm backend/autonomo_control.db && cd backend && python scripts/utils/seed_data.py

# Rodar somente testes de m√©tricas
pytest -k metrics -q

# Ver logs de requisi√ß√µes (FastAPI j√° mostra em stdout)
```

### 9. Solu√ß√£o de Problemas
| Sintoma | Causa Prov√°vel | Solu√ß√£o |
|--------|----------------|---------|
| `ModuleNotFoundError` | venv n√£o ativada | `source .venv/bin/activate` |
| Erro SQLite lock | Execu√ß√µes concorrentes | Feche processos / use Postgres em prod |
| 401 nas rotas | Falta token JWT | Autentique e envie `Authorization: Bearer <token>` |
| Campos corrida n√£o aparecem | Frontend antigo em cache | Hard refresh (Ctrl+Shift+R) |
| 403 ao criar ADMIN | Master password ausente | Adicionar header X-Master-Key |
| 403 Master password inv√°lida | Valor incorreto | Verifique vari√°vel de ambiente MASTER_PASSWORD |
| 403 promo√ß√£o/rebaixamento | Usu√°rio n√£o MASTER | Logar com conta MASTER |

### 10. Pr√≥ximos (Opcional)
| Objetivo | Passo inicial |
|----------|---------------|
| Usar PostgreSQL | Ajustar `DATABASE_URL=postgresql+psycopg://user:pass@host/db` em `.env` e rodar migra√ß√µes |
| Dockerizar | Criar `Dockerfile` multi-stage e `docker-compose.yml` com backend + frontend + db |
| CI | Adicionar workflow GitHub Actions rodando pytest + build frontend |

---

---

## üìä **Status Atual**

Refer√™ncia de planejamento cont√≠nuo detalhada em `PLANO_PREVC.md` (metodologia PREVC: Planejar, Revisar, Executar, Commitar).

### ‚úÖ **Backend - Sprint Motorista**
- üöñ Campos de corrida e m√©tricas di√°rias/mensais adicionados
- üéØ **236/236 testes passando** (inclui testes admin RBAC)
- üìä Cobertura alta (executar pytest --cov para n√∫mero atualizado)
- ‚úÖ **0 erros MyPy** (type safety perfeita)
- üîß **25+ endpoints** implementados
- üõ°Ô∏è **JWT + OAuth2** funcionando
- üóÑÔ∏è **SQLAlchemy + Alembic** configurado

### üîÑ **Frontend - 70% Implementado**
- ‚öõÔ∏è **React + TypeScript** configurado
- üé® **Tailwind CSS** para estiliza√ß√£o
- üì± **4/6 p√°ginas** implementadas
- üìä **Charts.js** para gr√°ficos
- üîê **Autentica√ß√£o** integrada
- üì± **Design responsivo** b√°sico

### üéØ **MVP - 80% Completo**
**Meta (revisada):** 100% at√© 30/06/2025

---

## üèóÔ∏è **Arquitetura Detalhada**

### **Estrutura Backend (FastAPI)**
```
üì¶ backend/
‚îú‚îÄ‚îÄ üöÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ üîå api/v1/              # Endpoints REST
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py            # Autentica√ß√£o (login, refresh)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entries.py         # CRUD lan√ßamentos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users.py           # Gest√£o de usu√°rios
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ categories.py      # Categorias personaliz√°veis
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ reports.py         # Relat√≥rios e an√°lises
‚îÇ   ‚îú‚îÄ‚îÄ ‚öôÔ∏è core/               # Configura√ß√µes centrais
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py          # Vari√°veis de ambiente
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ security.py        # JWT e seguran√ßa
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.py        # Conex√£o banco
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ exceptions.py      # Handlers de exce√ß√µes
‚îÇ   ‚îú‚îÄ‚îÄ üóÑÔ∏è models/             # SQLAlchemy Models
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py           # Modelo User
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entry.py          # Modelo Entry
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ category.py       # Modelo Category
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ base.py           # Base model
‚îÇ   ‚îú‚îÄ‚îÄ üìã schemas/            # Pydantic Schemas
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py           # Schemas User
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entry.py          # Schemas Entry
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ category.py       # Schemas Category
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ responses.py      # Padroniza√ß√£o respostas
‚îÇ   ‚îú‚îÄ‚îÄ ‚ö° services/           # L√≥gica de neg√≥cio
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ google_auth.py    # OAuth2 Google
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ email_service.py  # Envio de emails
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ storage.py        # Armazenamento arquivos
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ analytics.py      # An√°lise de dados
‚îÇ   ‚îú‚îÄ‚îÄ üß™ tests/             # 374 testes (99% coverage)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ unit/             # Testes unit√°rios
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ integration/      # Testes integra√ß√£o
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ conftest.py       # Configura√ß√µes
‚îÇ   ‚îú‚îÄ‚îÄ üîÑ migrations/        # Alembic migrations
‚îÇ   ‚îú‚îÄ‚îÄ main.py               # App FastAPI
‚îÇ   ‚îî‚îÄ‚îÄ dependencies.py       # Depend√™ncias compartilhadas
‚îú‚îÄ‚îÄ üê≥ Dockerfile             # Containeriza√ß√£o
‚îú‚îÄ‚îÄ üì¶ requirements.txt       # Depend√™ncias Python
‚îî‚îÄ‚îÄ ‚öôÔ∏è alembic.ini            # Config migra√ß√µes
```

### **Estrutura Frontend (React)**
```
üì¶ frontend/
‚îú‚îÄ‚îÄ üåê public/               # Arquivos est√°ticos
‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îú‚îÄ‚îÄ favicon.ico
‚îÇ   ‚îî‚îÄ‚îÄ manifest.json
‚îú‚îÄ‚îÄ ‚öõÔ∏è src/
‚îÇ   ‚îú‚îÄ‚îÄ üß© components/       # Componentes reutiliz√°veis
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/             # Componentes b√°sicos (Button, Input)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout/         # Header, Sidebar, Footer
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ forms/          # Formul√°rios espec√≠ficos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ charts/         # Visualiza√ß√£o de dados
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tables/         # Tabelas e listagens
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ modals/         # Modais e di√°logos
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ pages/           # P√°ginas da aplica√ß√£o
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/           # Login/Logout
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/      # Dashboard principal
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entries/        # Gest√£o lan√ßamentos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ reports/        # Relat√≥rios
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ settings/       # Configura√ß√µes
‚îÇ   ‚îú‚îÄ‚îÄ ü™ù hooks/           # Custom hooks
‚îÇ   ‚îú‚îÄ‚îÄ üîå services/        # APIs e integra√ß√µes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/            # Clientes API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ storage/        # Storage local
‚îÇ   ‚îú‚îÄ‚îÄ üõ†Ô∏è utils/           # Fun√ß√µes utilit√°rias
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ formatters/     # Data, moeda, etc
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ validators/     # Valida√ß√£o dados
‚îÇ   ‚îú‚îÄ‚îÄ üåç context/         # Estado global
‚îÇ   ‚îú‚îÄ‚îÄ üé® assets/          # Imagens, √≠cones
‚îÇ   ‚îú‚îÄ‚îÄ üìù types/           # Tipos TypeScript
‚îÇ   ‚îú‚îÄ‚îÄ App.jsx             # Componente principal
‚îÇ   ‚îú‚îÄ‚îÄ index.jsx           # Entry point
‚îÇ   ‚îî‚îÄ‚îÄ routes.jsx          # Defini√ß√£o rotas
‚îú‚îÄ‚îÄ üì¶ package.json         # Depend√™ncias npm
‚îú‚îÄ‚îÄ üé® tailwind.config.js   # Config Tailwind
‚îú‚îÄ‚îÄ ‚ö° vite.config.js       # Config Vite
‚îú‚îÄ‚îÄ üîç .eslintrc.js         # Config linter
‚îî‚îÄ‚îÄ üê≥ Dockerfile          # Containeriza√ß√£o
```

### **Diagrama de Arquitetura**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   üì± Frontend   ‚îÇ    ‚îÇ   üöÄ Backend     ‚îÇ    ‚îÇ   üóÑÔ∏è Database ‚îÇ
‚îÇ   (React TS)   ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ   (FastAPI)      ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ  (PostgreSQL)  ‚îÇ
‚îÇ   Port: 3000    ‚îÇ    ‚îÇ   Port: 8000     ‚îÇ    ‚îÇ   Port: 5432   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚ñ≤                       ‚ñ≤                       ‚ñ≤
        ‚îÇ                       ‚îÇ                       ‚îÇ
        ‚ñº                       ‚ñº                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üì¶ Static CDN  ‚îÇ    ‚îÇ  üîê OAuth APIs   ‚îÇ    ‚îÇ  ‚òÅÔ∏è Backups    ‚îÇ
‚îÇ  (Vercel/CDN)   ‚îÇ    ‚îÇ  (Google Auth)   ‚îÇ    ‚îÇ  (AWS S3)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üöÄ **Funcionalidades**

### ‚úÖ **Implementadas - Backend (atual)**
- üîê **Autentica√ß√£o** (JWT + Google OAuth2 + Refresh Tokens)
- üë§ **Gest√£o de usu√°rios** (CRUD completo)
- üìÇ **Categorias** (receitas/despesas + subcategorias)
- üí∞ **Lan√ßamentos financeiros** (CRUD completo com valida√ß√µes)
- üöñ **Campos de corrida**: platform, distance_km, duration_min, gross_amount, platform_fee, tips_amount, net_amount, shift_tag, city
- üìà **M√©tricas corridas**: `/entries/metrics/daily` & `/entries/metrics/monthly` (gross, net, fee %, tips, km, horas, R$/km, R$/hora)
- üìä **Dashboard** com resumos e estat√≠sticas
- üîç **Filtros avan√ßados** (data, tipo, categoria, valor)
- üìà **Relat√≥rios** (evolu√ß√£o e distribui√ß√£o)
- üõ°Ô∏è **Seguran√ßa** (prote√ß√£o OWASP Top 10)
- üóÑÔ∏è **Banco de dados** (SQLAlchemy + Alembic)

### ‚úÖ **Implementadas - Frontend 70%**
- ‚öõÔ∏è **React + TypeScript** configurado
- üé® **Tailwind CSS** para estiliza√ß√£o responsiva
- üì± **4/6 p√°ginas** implementadas
- üìä **Charts.js** para gr√°ficos interativos
- üîê **Autentica√ß√£o** integrada
- üéØ **Dashboard** funcional
- üìã **Listagem de lan√ßamentos** com filtros

### üîÑ **Em Desenvolvimento Ativo**
- üß™ **Testes frontend** (Jest + Testing Library)
- üìä **P√°gina de relat√≥rios** avan√ßados
- üìÑ **Exporta√ß√£o PDF/CSV**
- üì± **PWA** (Progressive Web App)
- üé® **Design responsivo** melhorado

### ‚è≥ **Planejadas - Roadmap**
- üê≥ **Docker** containeriza√ß√£o completa
- ‚òÅÔ∏è **Deploy produ√ß√£o** (Railway/Vercel)
- üóÑÔ∏è **PostgreSQL** migration
- üîó **APIs banc√°rias** (Open Banking)
- üìß **Relat√≥rios autom√°ticos**
- üì± **App m√≥vel nativo**
- üìé **Anexos** para lan√ßamentos
- üîî **Notifica√ß√µes** e alertas

---

## üíª **Stack Tecnol√≥gico**

### **Backend - FastAPI**
| Tecnologia | Vers√£o | Justificativa |
|------------|--------|---------------|
| **FastAPI** | 0.95+ | Alta performance, tipagem, documenta√ß√£o autom√°tica |
| **SQLAlchemy** | 2.0+ | ORM moderno com suporte async |
| **Alembic** | Latest | Migra√ß√µes de banco versionadas |
| **Pydantic** | 2.0+ | Valida√ß√£o de dados com tipagem |
| **JWT** | PyJWT | Autentica√ß√£o stateless segura |
| **OAuth2** | Google | Autentica√ß√£o social simplificada |
| **Pytest** | Latest | Framework de testes robusto |

### **Frontend - React**
| Tecnologia | Vers√£o | Justificativa |
|------------|--------|---------------|
| **React** | 18+ | Library UI moderna e madura |
| **TypeScript** | 5+ | Tipagem est√°tica e IntelliSense |
| **Tailwind CSS** | 3+ | CSS utility-first produtivo |
| **Chart.js** | 4+ | Gr√°ficos interativos performantes |
| **React Hook Form** | Latest | Formul√°rios otimizados |
| **Zod** | Latest | Valida√ß√£o de schemas TypeScript |
| **Vite** | Latest | Build tool r√°pido |

### **DevOps & Qualidade**
| Ferramenta | Uso |
|------------|-----|
| **Docker** | Containeriza√ß√£o para desenvolvimento |
| **GitHub Actions** | CI/CD autom√°tico |
| **ESLint + Prettier** | Qualidade e formata√ß√£o de c√≥digo |
| **MyPy** | Verifica√ß√£o de tipos Python |
| **Coverage.py** | Cobertura de testes (99%) |

---

## üîí **Seguran√ßa & Conformidade**

### **Seguran√ßa Implementada**
- üõ°Ô∏è **Prote√ß√£o OWASP Top 10** (inje√ß√£o SQL, XSS, CSRF)
- üîê **Tokens JWT** com refresh autom√°tico
- üîí **OAuth2** com Google (sem senhas locais)
- üßπ **Sanitiza√ß√£o** de inputs e valida√ß√£o rigorosa
- ‚ö° **Rate limiting** contra ataques de for√ßa bruta
- üö´ **CSP** (Content Security Policy)

### **Privacidade & LGPD**
- ‚úÖ **Conformidade LGPD** (Lei Geral de Prote√ß√£o de Dados)
- üìã **Pol√≠tica de privacidade** transparente
- ‚úã **Consentimento expl√≠cito** para coleta de dados
- üì§ **Exporta√ß√£o** e exclus√£o de dados pessoais
- üîí **Criptografia** de dados sens√≠veis

---

## üéØ **Pr√≥ximos Passos - Roadmap 2025**

### **üìÖ Janeiro 2025 - Conclu√≠do ‚úÖ**
- ‚úÖ **Limpeza de c√≥digo** - 8 arquivos duplicados removidos
- ‚úÖ **Melhoria testes** - Cobertura aumentada para 99%
- ‚úÖ **Zero falhas** - 374/374 testes passando
- ‚úÖ **Type safety** - Zero erros MyPy

### **üìÖ Esta Semana (27/05 - 03/06)**
1. üß™ **Frontend Testing Setup** - Jest + Testing Library
2. üé® **Responsive Design Review** - Mobile optimization
3. üìä **Reports Page** - Implementa√ß√£o completa

### **üìÖ Pr√≥ximas 2 Semanas (04/06 - 17/06)**
1. üê≥ **Docker Setup** - Containeriza√ß√£o completa
2. üóÑÔ∏è **PostgreSQL Migration** - Banco de produ√ß√£o
3. ‚òÅÔ∏è **Deploy Staging** - Ambiente de teste

### **üìÖ Pr√≥ximo M√™s (Junho 2025)**
1. üìÑ **Exporta√ß√£o PDF/CSV** - Relat√≥rios para download
2. üì± **PWA Implementation** - App instal√°vel
3. üîî **Notifica√ß√µes** - Alertas financeiros
4. üéØ **MVP 100%** - Meta: 30/06/2025

### **üìÖ Q3 2025 (Julho - Setembro)**
1. üì± **App M√≥vel Nativo** - React Native
2. üîó **APIs Banc√°rias** - Open Banking integration
3. üìé **Anexos** - Upload de comprovantes
4. ü§ñ **IA Financeira** - Insights autom√°ticos

### **üìÖ Q4 2025 (Outubro - Dezembro)**
1. üè¢ **Vers√£o Empresarial** - Multi-usu√°rios
2. üìß **Relat√≥rios Autom√°ticos** - Email scheduling
3. üåç **Internacionaliza√ß√£o** - M√∫ltiplos idiomas
4. üíé **Vers√£o Premium** - Recursos avan√ßados

*Para detalhes completos, consulte [üìä Progresso Consolidado](progresso_app.md)*

---

## üèÜ **Conquistas & Marcos Recentes**

### **üéâ Janeiro 2025**
- ‚ú® **Limpeza de c√≥digo** - 8 arquivos duplicados removidos (15/01/2025)
- üìà **99% cobertura** - Novo recorde de qualidade de testes
- üîí **Type safety** - Zero erros MyPy em 63 arquivos

### **üéâ Maio / Agosto 2025**
- üéØ **Zero falhas** - 374/374 testes passando (25/05/2025)
- ‚ö° **Backend 100%** - Todas as funcionalidades implementadas
- üöÄ **FastAPI** - 25+ endpoints funcionais
- üõ°Ô∏è **Seguran√ßa** - JWT + OAuth2 + Rate limiting

### **üìä M√©tricas Atuais (Sprint Motorista)**
- **Backend:** Modelo extendido + m√©tricas de corrida ativas
- **Frontend:** Campos de corrida integrados (formul√°rio, listagem, filtros plataforma/turno/cidade); dashboard de m√©tricas ainda pendente
- **Testes:** 231/231 passando
- **Cobertura:** alta (executar pytest --cov para n√∫mero preciso)
- **Type errors:** 0

---

## üß™ **Qualidade & Testes**

### **Backend Testing (atual)**
```bash
cd backend
pytest --cov=app --cov-report=term-missing
# Esperado: 231 passed
```

### **Frontend Testing - Em Implementa√ß√£o**
```bash
cd frontend
npm test            # Testes unit√°rios (em prepara√ß√£o)
```
Testes espec√≠ficos Admin Panel:
```bash
npm run test:ci -- src/components/admin
```

### **Code Quality Tools**
- ‚úÖ **MyPy** - Verifica√ß√£o de tipos Python
- ‚úÖ **ESLint** - Linting JavaScript/TypeScript
- ‚úÖ **Prettier** - Formata√ß√£o autom√°tica
- ‚úÖ **Black** - Formata√ß√£o Python
- ‚úÖ **Coverage.py** - Cobertura Python
- üîÑ **Husky** - Pre-commit hooks (em setup)

---

## üìû **Desenvolvimento & Contribui√ß√£o**

### **üõ†Ô∏è Ambiente de Desenvolvimento**
```bash
# Setup completo do projeto
git clone <repo-url>
cd autonomo-control

# Backend setup
cd backend
python -m venv venv
.\venv\Scripts\activate      # Windows
source venv/bin/activate     # Linux/Mac
pip install -r requirements.txt
python run_server.py

# Frontend setup
cd ../frontend
npm install
npm start

# Executar testes
cd ../backend && pytest --cov=app
cd ../frontend && npm test
```

### **üîÑ Fluxo de Desenvolvimento**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Feature   ‚îÇ   ‚îÇ   Commit &  ‚îÇ   ‚îÇ    Pull     ‚îÇ   ‚îÇ   Deploy    ‚îÇ
‚îÇ   Branch    ‚îú‚îÄ‚îÄ‚ñ∫‚îÇ    Push     ‚îú‚îÄ‚îÄ‚ñ∫‚îÇ   Request   ‚îú‚îÄ‚îÄ‚ñ∫‚îÇ   Staging   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                                               ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê            ‚ñº
‚îÇ   Deploy    ‚îÇ   ‚îÇ    User     ‚îÇ   ‚îÇ  Automated  ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Production  ‚îÇ‚óÑ‚îÄ‚îÄ‚î§ Acceptance  ‚îÇ‚óÑ‚îÄ‚îÄ‚î§    Tests    ‚îÇ    ‚îÇ   Manual    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ   Testing   ‚îÇ
                                                       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### **üìã Estrutura de Branches**
- üéØ `main` - C√≥digo em produ√ß√£o (stable)
- üöÄ `develop` - Pr√≥xima vers√£o em desenvolvimento
- ‚ö° `feature/*` - Funcionalidades em desenvolvimento
- üî• `hotfix/*` - Corre√ß√µes urgentes
- üß™ `test/*` - Experimentos e POCs

### **‚úÖ Padr√µes de C√≥digo**
- **Backend:** PEP 8 + MyPy + Black formatting
- **Frontend:** Airbnb Style Guide + ESLint + Prettier
- **Commits:** Conventional Commits (feat, fix, docs, etc.)
- **PRs:** Template com descri√ß√£o detalhada e checklist

### **üèóÔ∏è Tecnologias para Portfolio**
Este projeto demonstra compet√™ncia em:
- üîê **OAuth2 & JWT** - Autentica√ß√£o moderna e segura
- üìä **API RESTful** - Documenta√ß√£o autom√°tica Swagger/OpenAPI
- üèóÔ∏è **Arquitetura em Camadas** - Separation of concerns
- üìù **Tipagem Avan√ßada** - TypeScript + Pydantic type safety
- üé® **Design Patterns** - Repository, Dependency Injection, Singleton
- üß™ **Testing** - Unit√°rios, integra√ß√£o e E2E (99% coverage)
- üóÑÔ∏è **Database Migrations** - Versionamento schema com Alembic
- üì± **Frontend Responsivo** - Mobile-first design
- ‚ôø **Acessibilidade** - WCAG 2.1 AA compliant
- ‚ö° **Performance** - Lazy loading, caching, optimizations

---

## üìà **M√©tricas de Projeto**

### **üìä Status Geral**
- üìÖ **In√≠cio:** 15 de maio de 2025
- üéØ **MVP Meta:** 30 de junho de 2025
- üöÄ **Status:** Em desenvolvimento ativo
- üë• **Equipe:** 1 desenvolvedor full-stack
- üìù **Documenta√ß√£o:** 6 documentos consolidados

### **üíª C√≥digo**
- üìÇ **Reposit√≥rios:** Backend + Frontend separados
- üìã **Linhas de c√≥digo:** ~15.000 (estimativa)
- üß™ **Testes:** 374 testes automatizados
- üìä **Coverage:** 99% backend, 0% frontend (em setup)
        - Frontend coverage parcial (admin hooks/componentes) dispon√≠vel via `npm run test:ci`.
- üîç **Qualidade:** 0 erros MyPy, ESLint compliant

### **üèóÔ∏è Funcionalidades**
- ‚úÖ **Backend APIs:** 25+ endpoints implementados
- ‚öõÔ∏è **Frontend Pages:** 4/6 p√°ginas completas
- üîê **Autentica√ß√£o:** OAuth2 + JWT funcional
- üìä **Dashboard:** Gr√°ficos e m√©tricas ativas
- üóÑÔ∏è **Database:** SQLAlchemy models + Alembic

---

**üìÖ Projeto iniciado:** 15 de maio de 2025
**üéØ MVP previsto:** 30 de junho de 2025
**üöÄ Status:** Em desenvolvimento ativo

![Backend](https://img.shields.io/badge/FastAPI-009688?style=flat&logo=fastapi&logoColor=white)
![Frontend](https://img.shields.io/badge/React-61DAFB?style=flat&logo=react&logoColor=black)
![TypeScript](https://img.shields.io/badge/TypeScript-3178C6?style=flat&logo=typescript&logoColor=white)
![Python](https://img.shields.io/badge/Python-3776AB?style=flat&logo=python&logoColor=white)

---

## üß™ Checklist QA Painel Admin
Lista de verifica√ß√£o manual r√°pida antes de release.

### Prepara√ß√£o
- [ ] Vari√°veis `MASTER_EMAIL` e `MASTER_PASSWORD` definidas
- [ ] Usu√°rio MASTER criado / promovido automaticamente
- [ ] Logar como MASTER e obter token JWT v√°lido

### Cen√°rios CRUD Usu√°rios
- [ ] ADMIN consegue acessar `/admin/users`
- [ ] USER n√£o consegue acessar (redirect/login ou 403)
- [ ] ADMIN cria novo USER (sucesso)
- [ ] ADMIN tenta criar ADMIN (falha 403)
- [ ] MASTER cria ADMIN com master password correta (sucesso)
- [ ] MASTER cria ADMIN com master password incorreta (erro exibido no modal)

### Altera√ß√£o Role
- [ ] MASTER promove USER‚ÜíADMIN (toast sucesso)
- [ ] MASTER rebaixa ADMIN‚ÜíUSER (toast sucesso)
- [ ] ADMIN n√£o v√™ bot√µes promover/rebaixar

### Status / Ativa√ß√£o
- [ ] ADMIN desativa USER (status muda e toast sucesso)
- [ ] ADMIN tenta desativar ADMIN (bot√£o ausente ou inoperante)
- [ ] MASTER desativa ADMIN (sucesso)
- [ ] N√£o √© poss√≠vel desativar MASTER
- [ ] Usu√°rio inativo n√£o autentica (login bloqueado)

### Seguran√ßa UI
- [ ] Master Password n√£o persiste ap√≥s fechar modal
- [ ] A√ß√µes m√∫ltiplas durante loading s√£o bloqueadas (bot√µes disabled)
- [ ] Sem chamadas indevidas contendo `X-Master-Key` para opera√ß√µes que n√£o exigem

### Erros e Feedback
- [ ] Mensagem clara para master password inv√°lida
- [ ] Mensagem clara para a√ß√£o n√£o permitida (403 gen√©rico)
- [ ] Skeleton exibido no carregamento inicial
- [ ] Empty state exibido sem usu√°rios

### Regress√£o B√°sica
- [ ] Dashboard continua acess√≠vel
- [ ] Fluxos de lan√ßamentos (entries) intactos
- [ ] Logout funciona e limpa token

### P√≥s-Teste
- [ ] Atualizar plano (`PLANO_PAINEL_ADMIN.md`) com data da execu√ß√£o QA
- [ ] Registrar anomalias / bugs encontrados

---

## üìö **Status da Documenta√ß√£o**

### ‚úÖ **Unifica√ß√£o Conclu√≠da (30/05/2025)**

A documenta√ß√£o do projeto foi **completamente unificada e organizada**:

#### üéØ **Estrutura Atual:**
- **üìö Documenta√ß√£o Principal:** `DOCUMENTACAO_UNIFICADA.md` (overview completo)
- **üìä Progresso T√©cnico:** `progresso_app.md` (detalhes de desenvolvimento)
- **üóÇÔ∏è Arquivo Hist√≥rico:** `docs/historico/unificacao_30_05_2025/` (documentos consolidados)

#### ‚úÖ **Documentos Organizados:**
- 9 documentos movidos para arquivo hist√≥rico
- Cross-references estabelecidos entre documentos
- Navega√ß√£o simplificada implementada
- Status atualizado: **MVP 95% completo**

#### üéØ **Benef√≠cios da Unifica√ß√£o:**
- **Uma √∫nica fonte de verdade** para status do projeto
- **Navega√ß√£o mais simples** entre documentos
- **Hist√≥rico preservado** para rastreabilidade
- **Informa√ß√µes atualizadas** com status real

### üìã **Pr√≥xima Atualiza√ß√£o:** Ap√≥s conclus√£o do Frontend Testing Setup

---
